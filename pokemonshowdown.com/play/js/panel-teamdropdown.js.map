{"version":3,"file":"panel-teamdropdown.js","names":["PSTeambuilder","packTeam","team","buf","_i2","length","set","hasHP","name","species","id","toID","item","ability","moves","j","moveid","substr","slice","nature","evs","gender","ivs","shiny","level","happiness","undefined","pokeball","hpType","gigantamax","dynamaxLevel","unpackTeam","_i4","_buf$split2","split","setBuf","parts","push","Dex","get","items","baseSpecies","includes","abilities","map","hp","Number","atk","def","spa","spd","spe","parseInt","misc","exportSet","text","_i6","_set$moves2","move","first","_i8","_Dex$statNames2","statNames","stat","BattleStatNames","_i10","_Dex$statNames4","isNaN","exportTeam","sets","_i12","splitPrefix","buffer","delimiter","prefixOffset","arguments","delimIndex","indexOf","splitLast","lastIndexOf","parseExportedTeamLine","line","isFirstLine","_line$split","endsWith","parenIndex","charAt","startsWith","evLines","_i14","evLine","trim","spaceIndex","statid","BattleStatIDs","statval","ivLines","_i16","ivLine","match","natureIndex","types","isName","hpIVs","HPivs","importTeam","lines","curSet","shift","pop","_i18","PS","teams","unpackLine","packedTeam","importTeamBackup","curTeam","_i20","format","folder","key","iconCache","_ref","_this$splitPrefix","packedTeamNames","i","k","TeamFolder","props","cur","preact","h","value","children","TeamBox","contents","icons","style","getPokemonIcon","button","noLink","draggable","TeamDropdownPanel","_PSRoomPanel","_inheritsLoose","_this","_len","args","Array","_key","call","apply","concat","gen","setFormat","e","target","currentTarget","forceUpdate","click","curTarget","tagName","parentElement","chooseParentValue","_proto","prototype","getTeams","_this2","list","filter","render","_this3","room","parentElem","PSPanelWrapper","baseFormat","getAttribute","modid","isFirstLoad","availableWidth","document","body","offsetWidth","width","teamBuckets","_i22","_teams2","teamList","baseGen","genList","_i24","_PS$teams$list2","hasOtherGens","onClick","sort","isEmpty","PSRoomPanel","FormatDropdownPanel","_PSRoomPanel2","_this4","_len2","_key2","_proto2","_this5","formatsLoaded","window","BattleFormats","selectType","formats","Object","values","challengeShow","searchShow","curSection","curColumnNum","curColumn","columns","_i26","column","section","replace","roomTypes","Component"],"sources":["../src/panel-teamdropdown.tsx"],"sourcesContent":["/**\n * Team Selector Panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nclass PSTeambuilder {\n\tstatic packTeam(team: PokemonSet[]) {\n\t\tlet buf = '';\n\t\tif (!team) return '';\n\n\t\tfor (const set of team) {\n\t\t\tlet hasHP = '';\n\t\t\tif (buf) buf += ']';\n\n\t\t\t// name\n\t\t\tbuf += set.name || set.species;\n\n\t\t\t// species\n\t\t\tlet id = toID(set.species);\n\t\t\tbuf += '|' + (toID(set.name || set.species) === id ? '' : id);\n\n\t\t\t// item\n\t\t\tbuf += '|' + toID(set.item);\n\n\t\t\t// ability\n\t\t\tid = toID(set.ability);\n\t\t\tbuf += '|' + (id || '-');\n\n\t\t\t// moves\n\t\t\tbuf += '|';\n\t\t\tif (set.moves) {\n\t\t\t\tfor (let j = 0; j < set.moves.length; j++) {\n\t\t\t\t\tlet moveid = toID(set.moves[j]);\n\t\t\t\t\tif (j && !moveid) continue;\n\t\t\t\t\tbuf += (j ? ',' : '') + moveid;\n\t\t\t\t\tif (moveid.substr(0, 11) === 'hiddenpower' && moveid.length > 11) {\n\t\t\t\t\t\thasHP = moveid.slice(11);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// nature\n\t\t\tbuf += '|' + (set.nature || '');\n\n\t\t\t// evs\n\t\t\tif (set.evs) {\n\t\t\t\tbuf += '|' + (set.evs['hp'] || '') + ',' +\n\t\t\t\t\t(set.evs['atk'] || '') + ',' +\n\t\t\t\t\t(set.evs['def'] || '') + ',' +\n\t\t\t\t\t(set.evs['spa'] || '') + ',' +\n\t\t\t\t\t(set.evs['spd'] || '') + ',' +\n\t\t\t\t\t(set.evs['spe'] || '');\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// gender\n\t\t\tif (set.gender) {\n\t\t\t\tbuf += '|' + set.gender;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// ivs\n\t\t\tif (set.ivs) {\n\t\t\t\tbuf += '|' + (set.ivs['hp'] === 31 ? '' : set.ivs['hp']) + ',' +\n\t\t\t\t\t(set.ivs['atk'] === 31 ? '' : set.ivs['atk']) + ',' +\n\t\t\t\t\t(set.ivs['def'] === 31 ? '' : set.ivs['def']) + ',' +\n\t\t\t\t\t(set.ivs['spa'] === 31 ? '' : set.ivs['spa']) + ',' +\n\t\t\t\t\t(set.ivs['spd'] === 31 ? '' : set.ivs['spd']) + ',' +\n\t\t\t\t\t(set.ivs['spe'] === 31 ? '' : set.ivs['spe']);\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// shiny\n\t\t\tif (set.shiny) {\n\t\t\t\tbuf += '|S';\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// level\n\t\t\tif (set.level) {\n\t\t\t\tbuf += '|' + set.level;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// happiness\n\t\t\tif (set.happiness !== undefined) {\n\t\t\t\tbuf += '|' + set.happiness;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tset.pokeball || (set.hpType && toID(set.hpType) !== hasHP) || set.gigantamax ||\n\t\t\t\t(set.dynamaxLevel !== undefined && set.dynamaxLevel !== 10)\n\t\t\t) {\n\t\t\t\tbuf += ',' + (set.hpType || '');\n\t\t\t\tbuf += ',' + toID(set.pokeball);\n\t\t\t\tbuf += ',' + (set.gigantamax ? 'G' : '');\n\t\t\t\tbuf += ',' + (set.dynamaxLevel !== undefined && set.dynamaxLevel !== 10 ? set.dynamaxLevel : '');\n\t\t\t}\n\t\t}\n\n\t\treturn buf;\n\t}\n\n\tstatic unpackTeam(buf: string) {\n\t\tif (!buf) return [];\n\n\t\tlet team: PokemonSet[] = [];\n\n\t\tfor (const setBuf of buf.split(`]`)) {\n\t\t\tconst parts = setBuf.split(`|`);\n\t\t\tif (parts.length < 11) continue;\n\t\t\tlet set: PokemonSet = {species: '', moves: []};\n\t\t\tteam.push(set);\n\n\t\t\t// name\n\t\t\tset.name = parts[0];\n\n\t\t\t// species\n\t\t\tset.species = Dex.species.get(parts[1]).name || set.name;\n\n\t\t\t// item\n\t\t\tset.item = Dex.items.get(parts[2]).name;\n\n\t\t\t// ability\n\t\t\tconst species = Dex.species.get(set.species);\n\t\t\tset.ability = parts[3] === '-' ?\n\t\t\t\t'' :\n\t\t\t\t(species.baseSpecies === 'Zygarde' && parts[3] === 'H') ?\n\t\t\t\t'Power Construct' :\n\t\t\t\t['', '0', '1', 'H', 'S'].includes(parts[3]) ?\n\t\t\t\tspecies.abilities[parts[3] as '0' || '0'] || (parts[3] === '' ? '' : '!!!ERROR!!!') :\n\t\t\t\tDex.abilities.get(parts[3]).name;\n\n\t\t\t// moves\n\t\t\tset.moves = parts[4].split(',').map(moveid =>\n\t\t\t\tDex.moves.get(moveid).name\n\t\t\t);\n\n\t\t\t// nature\n\t\t\tset.nature = parts[5] as NatureName;\n\t\t\tif (set.nature as any === 'undefined') set.nature = undefined;\n\n\t\t\t// evs\n\t\t\tif (parts[6]) {\n\t\t\t\tif (parts[6].length > 5) {\n\t\t\t\t\tconst evs = parts[6].split(',');\n\t\t\t\t\tset.evs = {\n\t\t\t\t\t\thp: Number(evs[0]) || 0,\n\t\t\t\t\t\tatk: Number(evs[1]) || 0,\n\t\t\t\t\t\tdef: Number(evs[2]) || 0,\n\t\t\t\t\t\tspa: Number(evs[3]) || 0,\n\t\t\t\t\t\tspd: Number(evs[4]) || 0,\n\t\t\t\t\t\tspe: Number(evs[5]) || 0,\n\t\t\t\t\t};\n\t\t\t\t} else if (parts[6] === '0') {\n\t\t\t\t\tset.evs = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// gender\n\t\t\tif (parts[7]) set.gender = parts[7];\n\n\t\t\t// ivs\n\t\t\tif (parts[8]) {\n\t\t\t\tconst ivs = parts[8].split(',');\n\t\t\t\tset.ivs = {\n\t\t\t\t\thp: ivs[0] === '' ? 31 : Number(ivs[0]),\n\t\t\t\t\tatk: ivs[1] === '' ? 31 : Number(ivs[1]),\n\t\t\t\t\tdef: ivs[2] === '' ? 31 : Number(ivs[2]),\n\t\t\t\t\tspa: ivs[3] === '' ? 31 : Number(ivs[3]),\n\t\t\t\t\tspd: ivs[4] === '' ? 31 : Number(ivs[4]),\n\t\t\t\t\tspe: ivs[5] === '' ? 31 : Number(ivs[5]),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// shiny\n\t\t\tif (parts[9]) set.shiny = true;\n\n\t\t\t// level\n\t\t\tif (parts[10]) set.level = parseInt(parts[9], 10);\n\n\t\t\t// happiness\n\t\t\tif (parts[11]) {\n\t\t\t\tlet misc = parts[11].split(',', 4);\n\t\t\t\tset.happiness = (misc[0] ? Number(misc[0]) : undefined);\n\t\t\t\tset.hpType = misc[1];\n\t\t\t\tset.pokeball = misc[2];\n\t\t\t\tset.gigantamax = !!misc[3];\n\t\t\t\tset.dynamaxLevel = (misc[4] ? Number(misc[4]) : 10);\n\t\t\t}\n\t\t}\n\n\t\treturn team;\n\t}\n\t/**\n\t * (Exports end with two spaces so linebreaks are preserved in Markdown;\n\t * I assume mostly for Reddit.)\n\t */\n\tstatic exportSet(set: PokemonSet) {\n\t\tlet text = '';\n\n\t\t// core\n\t\tif (set.name && set.name !== set.species) {\n\t\t\ttext += `${set.name} (${set.species})`;\n\t\t} else {\n\t\t\ttext += `${set.species}`;\n\t\t}\n\t\tif (set.gender === 'M') text += ` (M)`;\n\t\tif (set.gender === 'F') text += ` (F)`;\n\t\tif (set.item) {\n\t\t\ttext += ` @ ${set.item}`;\n\t\t}\n\t\ttext += `  \\n`;\n\t\tif (set.ability) {\n\t\t\ttext += `Ability: ${set.ability}  \\n`;\n\t\t}\n\t\tif (set.moves) {\n\t\t\tfor (let move of set.moves) {\n\t\t\t\tif (move.substr(0, 13) === 'Hidden Power ') {\n\t\t\t\t\tconst hpType = move.slice(13);\n\t\t\t\t\tmove = move.slice(0, 13);\n\t\t\t\t\tmove = `${move}[${hpType}]`;\n\t\t\t\t}\n\t\t\t\tif (move) {\n\t\t\t\t\ttext += `- ${move}  \\n`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// stats\n\t\tlet first = true;\n\t\tif (set.evs) {\n\t\t\tfor (const stat of Dex.statNames) {\n\t\t\t\tif (!set.evs[stat]) continue;\n\t\t\t\tif (first) {\n\t\t\t\t\ttext += `EVs: `;\n\t\t\t\t\tfirst = false;\n\t\t\t\t} else {\n\t\t\t\t\ttext += ` / `;\n\t\t\t\t}\n\t\t\t\ttext += `${set.evs[stat]} ${BattleStatNames[stat]}`;\n\t\t\t}\n\t\t}\n\t\tif (!first) {\n\t\t\ttext += `  \\n`;\n\t\t}\n\t\tif (set.nature) {\n\t\t\ttext += `${set.nature} Nature  \\n`;\n\t\t}\n\t\tfirst = true;\n\t\tif (set.ivs) {\n\t\t\tfor (const stat of Dex.statNames) {\n\t\t\t\tif (set.ivs[stat] === undefined || isNaN(set.ivs[stat]) || set.ivs[stat] === 31) continue;\n\t\t\t\tif (first) {\n\t\t\t\t\ttext += `IVs: `;\n\t\t\t\t\tfirst = false;\n\t\t\t\t} else {\n\t\t\t\t\ttext += ` / `;\n\t\t\t\t}\n\t\t\t\ttext += `${set.ivs[stat]} ${BattleStatNames[stat]}`;\n\t\t\t}\n\t\t}\n\t\tif (!first) {\n\t\t\ttext += `  \\n`;\n\t\t}\n\n\t\t// details\n\t\tif (set.level && set.level !== 100) {\n\t\t\ttext += `Level: ${set.level}  \\n`;\n\t\t}\n\t\tif (set.shiny) {\n\t\t\ttext += `Shiny: Yes  \\n`;\n\t\t}\n\t\tif (typeof set.happiness === 'number' && set.happiness !== 255 && !isNaN(set.happiness)) {\n\t\t\ttext += `Happiness: ${set.happiness}  \\n`;\n\t\t}\n\t\tif (typeof set.dynamaxLevel === 'number' && set.dynamaxLevel !== 255 && !isNaN(set.dynamaxLevel)) {\n\t\t\ttext += `Dynamax Level: ${set.dynamaxLevel}  \\n`;\n\t\t}\n\t\tif (set.gigantamax) {\n\t\t\ttext += `Gigantamax: Yes  \\n`;\n\t\t}\n\n\t\ttext += `\\n`;\n\t\treturn text;\n\t}\n\tstatic exportTeam(sets: PokemonSet[]) {\n\t\tlet text = '';\n\t\tfor (const set of sets) {\n\t\t\t// core\n\t\t\ttext += PSTeambuilder.exportSet(set);\n\t\t}\n\t\treturn text;\n\t}\n\tstatic splitPrefix(buffer: string, delimiter: string, prefixOffset = 0): [string, string] {\n\t\tconst delimIndex = buffer.indexOf(delimiter);\n\t\tif (delimIndex < 0) return ['', buffer];\n\t\treturn [buffer.slice(prefixOffset, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic splitLast(buffer: string, delimiter: string): [string, string] {\n\t\tconst delimIndex = buffer.lastIndexOf(delimiter);\n\t\tif (delimIndex < 0) return [buffer, ''];\n\t\treturn [buffer.slice(0, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic parseExportedTeamLine(line: string, isFirstLine: boolean, set: PokemonSet) {\n\t\tif (isFirstLine) {\n\t\t\tlet item;\n\t\t\t[line, item] = line.split(' @ ');\n\t\t\tif (item) {\n\t\t\t\tset.item = item;\n\t\t\t\tif (toID(set.item) === 'noitem') set.item = '';\n\t\t\t}\n\t\t\tif (line.endsWith(' (M)')) {\n\t\t\t\tset.gender = 'M';\n\t\t\t\tline = line.slice(0, -4);\n\t\t\t}\n\t\t\tif (line.endsWith(' (F)')) {\n\t\t\t\tset.gender = 'F';\n\t\t\t\tline = line.slice(0, -4);\n\t\t\t}\n\t\t\tlet parenIndex = line.lastIndexOf(' (');\n\t\t\tif (line.charAt(line.length - 1) === ')' && parenIndex !== -1) {\n\t\t\t\tset.species = Dex.species.get(line.slice(parenIndex + 2, -1)).name;\n\t\t\t\tset.name = line.slice(0, parenIndex);\n\t\t\t} else {\n\t\t\t\tset.species = Dex.species.get(line).name;\n\t\t\t\tset.name = '';\n\t\t\t}\n\t\t} else if (line.startsWith('Trait: ')) {\n\t\t\tline = line.slice(7);\n\t\t\tset.ability = line;\n\t\t} else if (line.startsWith('Ability: ')) {\n\t\t\tline = line.slice(9);\n\t\t\tset.ability = line;\n\t\t} else if (line === 'Shiny: Yes') {\n\t\t\tset.shiny = true;\n\t\t} else if (line.startsWith('Level: ')) {\n\t\t\tline = line.slice(7);\n\t\t\tset.level = +line;\n\t\t} else if (line.startsWith('Happiness: ')) {\n\t\t\tline = line.slice(11);\n\t\t\tset.happiness = +line;\n\t\t} else if (line.startsWith('Pokeball: ')) {\n\t\t\tline = line.slice(10);\n\t\t\tset.pokeball = line;\n\t\t} else if (line.startsWith('Hidden Power: ')) {\n\t\t\tline = line.slice(14);\n\t\t\tset.hpType = line;\n\t\t} else if (line.startsWith('Dynamax Level: ')) {\n\t\t\tline = line.substr(15);\n\t\t\tset.dynamaxLevel = +line;\n\t\t} else if (line === 'Gigantamax: Yes') {\n\t\t\tset.gigantamax = true;\n\t\t} else if (line.startsWith('EVs: ')) {\n\t\t\tline = line.slice(5);\n\t\t\tlet evLines = line.split('/');\n\t\t\tset.evs = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\tfor (let evLine of evLines) {\n\t\t\t\tevLine = evLine.trim();\n\t\t\t\tlet spaceIndex = evLine.indexOf(' ');\n\t\t\t\tif (spaceIndex === -1) continue;\n\t\t\t\tlet statid = BattleStatIDs[evLine.slice(spaceIndex + 1)];\n\t\t\t\tif (!statid) continue;\n\t\t\t\tlet statval = parseInt(evLine.slice(0, spaceIndex), 10);\n\t\t\t\tset.evs[statid] = statval;\n\t\t\t}\n\t\t} else if (line.startsWith('IVs: ')) {\n\t\t\tline = line.slice(5);\n\t\t\tlet ivLines = line.split(' / ');\n\t\t\tset.ivs = {hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31};\n\t\t\tfor (let ivLine of ivLines) {\n\t\t\t\tivLine = ivLine.trim();\n\t\t\t\tlet spaceIndex = ivLine.indexOf(' ');\n\t\t\t\tif (spaceIndex === -1) continue;\n\t\t\t\tlet statid = BattleStatIDs[ivLine.slice(spaceIndex + 1)];\n\t\t\t\tif (!statid) continue;\n\t\t\t\tlet statval = parseInt(ivLine.slice(0, spaceIndex), 10);\n\t\t\t\tif (isNaN(statval)) statval = 31;\n\t\t\t\tset.ivs[statid] = statval;\n\t\t\t}\n\t\t} else if (line.match(/^[A-Za-z]+ (N|n)ature/)) {\n\t\t\tlet natureIndex = line.indexOf(' Nature');\n\t\t\tif (natureIndex === -1) natureIndex = line.indexOf(' nature');\n\t\t\tif (natureIndex === -1) return;\n\t\t\tline = line.substr(0, natureIndex);\n\t\t\tif (line !== 'undefined') set.nature = line as NatureName;\n\t\t} else if (line.charAt(0) === '-' || line.charAt(0) === '~') {\n\t\t\tline = line.slice(line.charAt(1) === ' ' ? 2 : 1);\n\t\t\tif (line.startsWith('Hidden Power [')) {\n\t\t\t\tconst hpType = line.slice(14, -1) as TypeName;\n\t\t\t\tline = 'Hidden Power ' + hpType;\n\t\t\t\tif (!set.ivs && Dex.types.isName(hpType)) {\n\t\t\t\t\tset.ivs = {hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31};\n\t\t\t\t\tconst hpIVs = Dex.types.get(hpType).HPivs || {};\n\t\t\t\t\tfor (let stat in hpIVs) {\n\t\t\t\t\t\tset.ivs[stat as StatName] = hpIVs[stat as StatName]!;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line === 'Frustration' && set.happiness === undefined) {\n\t\t\t\tset.happiness = 0;\n\t\t\t}\n\t\t\tset.moves.push(line);\n\t\t}\n\t}\n\tstatic importTeam(buffer: string): PokemonSet[] {\n\t\tconst lines = buffer.split(\"\\n\");\n\n\t\tconst sets: PokemonSet[] = [];\n\t\tlet curSet: PokemonSet | null = null;\n\n\t\twhile (lines.length && !lines[0]) lines.shift();\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\n\n\t\tif (lines.length === 1 && lines[0].includes('|')) {\n\t\t\treturn this.unpackTeam(lines[0]);\n\t\t}\n\t\tfor (let line of lines) {\n\t\t\tline = line.trim();\n\t\t\tif (line === '' || line === '---') {\n\t\t\t\tcurSet = null;\n\t\t\t} else if (line.startsWith('===')) {\n\t\t\t\t// team backup format; ignore\n\t\t\t} else if (line.includes('|')) {\n\t\t\t\t// packed format\n\t\t\t\tconst team = PS.teams.unpackLine(line);\n\t\t\t\tif (!team) continue;\n\t\t\t\treturn this.unpackTeam(team.packedTeam);\n\t\t\t} else if (!curSet) {\n\t\t\t\tcurSet = {\n\t\t\t\t\tname: '', species: '', gender: '',\n\t\t\t\t\tmoves: [],\n\t\t\t\t};\n\t\t\t\tsets.push(curSet);\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\n\t\t\t} else {\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\n\t\t\t}\n\t\t}\n\t\treturn sets;\n\t}\n\tstatic importTeamBackup(buffer: string): Team[] {\n\t\tconst teams: Team[] = [];\n\t\tconst lines = buffer.split(\"\\n\");\n\n\t\tlet curTeam: Team | null = null;\n\t\tlet sets: PokemonSet[] | null = null;\n\n\t\tlet curSet: PokemonSet | null = null;\n\n\t\twhile (lines.length && !lines[0]) lines.shift();\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\n\n\t\tfor (let line of lines) {\n\t\t\tline = line.trim();\n\t\t\tif (line === '' || line === '---') {\n\t\t\t\tcurSet = null;\n\t\t\t} else if (line.startsWith('===')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\n\t\t\t\tcurTeam = {\n\t\t\t\t\tname: '',\n\t\t\t\t\tformat: '' as ID,\n\t\t\t\t\tpackedTeam: '',\n\t\t\t\t\tfolder: '',\n\t\t\t\t\tkey: '',\n\t\t\t\t\ticonCache: '',\n\t\t\t\t};\n\t\t\t\tsets = [];\n\n\t\t\t\tline = line.slice(3, -3).trim();\n\t\t\t\t[curTeam.format, line] = this.splitPrefix(line, ']', 1) as [ID, string];\n\t\t\t\tif (!curTeam.format) curTeam.format = 'gen8' as ID;\n\t\t\t\telse if (!curTeam.format.startsWith('gen')) curTeam.format = `gen6${curTeam.format}` as ID;\n\n\t\t\t\t[curTeam.folder, curTeam.name] = this.splitPrefix(line, '/');\n\t\t\t} else if (line.includes('|')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\t\t\t\tcurTeam = null;\n\t\t\t\tcurSet = null;\n\t\t\t\tconst team = PS.teams.unpackLine(line);\n\t\t\t\tif (team) teams.push(team);\n\t\t\t} else if (!curSet) {\n\t\t\t\tif (!sets) continue; // corruption\n\t\t\t\tcurSet = {\n\t\t\t\t\tname: '', species: '', gender: '',\n\t\t\t\t\tmoves: [],\n\t\t\t\t};\n\t\t\t\tsets.push(curSet);\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\n\t\t\t} else {\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\n\t\t\t}\n\t\t}\n\t\tif (curTeam) {\n\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\tteams.push(curTeam);\n\t\t}\n\t\treturn teams;\n\t}\n\n\tstatic packedTeamNames(buf: string) {\n\t\tif (!buf) return [];\n\n\t\tconst team = [];\n\t\tlet i = 0;\n\n\t\twhile (true) {\n\t\t\tconst name = buf.slice(i, buf.indexOf('|', i));\n\t\t\ti = buf.indexOf('|', i) + 1;\n\n\t\t\tteam.push(buf.slice(i, buf.indexOf('|', i)) || name);\n\n\t\t\tfor (let k = 0; k < 9; k++) {\n\t\t\t\ti = buf.indexOf('|', i) + 1;\n\t\t\t}\n\n\t\t\ti = buf.indexOf(']', i) + 1;\n\n\t\t\tif (i < 1) break;\n\t\t}\n\n\t\treturn team;\n\t}\n}\n\nfunction TeamFolder(props: {cur?: boolean, value: string, children: preact.ComponentChildren}) {\n\t// folders are <div>s rather than <button>s because in theory it has\n\t// less weird interactions with HTML5 drag-and-drop\n\tif (props.cur) {\n\t\treturn <div class=\"folder cur\"><div class=\"folderhack3\">\n\t\t\t<div class=\"folderhack1\"></div><div class=\"folderhack2\"></div>\n\t\t\t<div class=\"selectFolder\" data-value={props.value}>{props.children}</div>\n\t\t</div></div>;\n\t}\n\treturn <div class=\"folder\">\n\t\t<div class=\"selectFolder\" data-value={props.value}>{props.children}</div>\n\t</div>;\n}\n\nfunction TeamBox(props: {team: Team | null, noLink?: boolean, button?: boolean}) {\n\tconst team = props.team;\n\tlet contents;\n\tif (team) {\n\t\tlet icons = team.iconCache;\n\t\tif (!icons) {\n\t\t\tif (!team.packedTeam) {\n\t\t\t\ticons = <em>(empty team)</em>;\n\t\t\t} else {\n\t\t\t\ticons = PSTeambuilder.packedTeamNames(team.packedTeam).map(species =>\n\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(species)}></span>\n\t\t\t\t);\n\t\t\t}\n\t\t\tteam.iconCache = icons;\n\t\t}\n\t\tlet format = team.format as string;\n\t\tif (format.startsWith('gen8')) format = format.slice(4);\n\t\tformat = (format ? `[${format}] ` : ``) + (team.folder ? `${team.folder}/` : ``);\n\t\tcontents = [\n\t\t\t<strong>{format && <span>{format}</span>}{team.name}</strong>,\n\t\t\t<small>{icons}</small>,\n\t\t];\n\t} else {\n\t\tcontents = [\n\t\t\t<em>Select a team</em>,\n\t\t];\n\t}\n\tif (props.button) {\n\t\treturn <button class=\"team\" value={team ? team.key : ''}>\n\t\t\t{contents}\n\t\t</button>;\n\t}\n\treturn <div data-href={props.noLink ? '' : `/team-${team ? team.key : ''}`} class=\"team\" draggable>\n\t\t{contents}\n\t</div>;\n}\n\n/**\n * Team selector popup\n */\n\nclass TeamDropdownPanel extends PSRoomPanel {\n\tgen = '';\n\tformat: string | null = null;\n\tgetTeams() {\n\t\tif (!this.format && !this.gen) return PS.teams.list;\n\t\treturn PS.teams.list.filter(team => {\n\t\t\tif (this.gen && !team.format.startsWith(this.gen)) return false;\n\t\t\tif (this.format && team.format !== this.format) return false;\n\t\t\treturn true;\n\t\t});\n\t}\n\tsetFormat = (e: MouseEvent) => {\n\t\tconst target = e.currentTarget as HTMLButtonElement;\n\t\tthis.format = (target.name === 'format' && target.value) || '';\n\t\tthis.gen = (target.name === 'gen' && target.value) || '';\n\t\tthis.forceUpdate();\n\t};\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tthis.chooseParentValue(target.value);\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a team selector, but you have nothing to select a team for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\t\tconst baseFormat = room.parentElem.getAttribute('data-format') || Dex.modid;\n\t\tlet isFirstLoad = this.format === null;\n\t\tif (isFirstLoad) {\n\t\t\tthis.format = baseFormat;\n\t\t}\n\t\tlet teams = this.getTeams();\n\t\tif (!teams.length && this.format && isFirstLoad) {\n\t\t\tthis.gen = this.format.slice(0, 4);\n\t\t\tthis.format = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\t\tif (!teams.length && this.gen && isFirstLoad) {\n\t\t\tthis.gen = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\n\t\tlet availableWidth = document.body.offsetWidth;\n\t\tlet width = 307;\n\t\tif (availableWidth > 636) width = 613;\n\t\tif (availableWidth > 945) width = 919;\n\n\t\tlet teamBuckets: {[folder: string]: Team[]} = {};\n\t\tfor (const team of teams) {\n\t\t\tconst list = teamBuckets[team.folder] || (teamBuckets[team.folder] = []);\n\t\t\tlist.push(team);\n\t\t}\n\n\t\tlet teamList = [];\n\n\t\tconst baseGen = baseFormat.slice(0, 4);\n\t\tlet genList: string[] = [];\n\t\tfor (const team of PS.teams.list) {\n\t\t\tconst gen = team.format.slice(0, 4);\n\t\t\tif (gen && !genList.includes(gen)) genList.push(gen);\n\t\t}\n\t\tconst hasOtherGens = genList.length > 1 || genList[0] !== baseGen;\n\n\t\tteamList.push(<p>\n\t\t\t{baseFormat.length > 4 && <button class={'button' + (baseFormat === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseFormat}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseFormat.slice(0, 4)}] {baseFormat.slice(4)}\n\t\t\t</button>} <button class={'button' + (baseGen === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseGen}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseGen}] <em>(uncategorized)</em>\n\t\t\t</button> <button class={'button' + (baseGen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={baseGen}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseGen}] <em>(all)</em>\n\t\t\t</button> {hasOtherGens && !this.gen && <button class=\"button\" onClick={this.setFormat} name=\"gen\" value={baseGen}>Other gens</button>}\n\t\t</p>);\n\n\t\tif (hasOtherGens && this.gen) {\n\t\t\tteamList.push(<h2>Other gens</h2>);\n\t\t\tteamList.push(<p>{genList.sort().map(gen => [\n\t\t\t\t<button class={'button' + (gen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={gen}>\n\t\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{gen}] <em>(all)</em>\n\t\t\t\t</button>,\n\t\t\t\t\" \",\n\t\t\t])}</p>);\n\t\t}\n\n\t\tlet isEmpty = true;\n\t\tfor (let folder in teamBuckets) {\n\t\t\tif (folder && (this.gen || this.format)) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\"></i> {folder} + {}\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else if (folder) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\"></i> {folder}\n\t\t\t\t</h2>);\n\t\t\t} else if (this.gen || this.format) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> Teams not in any folders\n\t\t\t\t</h2>);\n\t\t\t}\n\t\t\tteamList.push(<ul class=\"teamdropdown\" onClick={this.click}>\n\t\t\t\t{teamBuckets[folder].map(team => <li key={team.key} style={\"display:inline-block\"}>\n\t\t\t\t\t<TeamBox team={team} button />\n\t\t\t\t</li>)}\n\t\t\t</ul>);\n\t\t\tisEmpty = false;\n\t\t}\n\n\t\treturn <PSPanelWrapper room={room} width={width}>\n\t\t\t{teamList}\n\t\t\t{isEmpty && <p><em>No teams found</em></p>}\n\t\t</PSPanelWrapper>;\n\t}\n}\n\ninterface FormatData {\n\tid: ID;\n\tname: string;\n\tteam?: 'preset' | null;\n\tsection: string;\n\tcolumn: number;\n\tsearchShow?: boolean;\n\tchallengeShow?: boolean;\n\ttournamentShow?: boolean;\n\trated: boolean;\n\tteambuilderLevel?: number | null;\n\tteambuilderFormat?: ID;\n\tbattleFormat?: string;\n\tisTeambuilderFormat: boolean;\n\teffectType: 'Format';\n}\n\ndeclare var BattleFormats: {[id: string]: FormatData};\n/** id:name */\ndeclare var NonBattleGames: {[id: string]: string};\n\nclass FormatDropdownPanel extends PSRoomPanel {\n\tgen = '';\n\tformat: string | null = null;\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tthis.chooseParentValue(target.value);\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a format selector, but you have nothing to select a format for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\tlet formatsLoaded = !!window.BattleFormats;\n\t\tif (formatsLoaded) {\n\t\t\tformatsLoaded = false;\n\t\t\tfor (let i in window.BattleFormats) {\n\t\t\t\tformatsLoaded = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!formatsLoaded) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Loading...</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\t/**\n\t\t * 'challenge' hides search-only formats, and 'search' hides challenge-only\n\t\t * formats. 'teambuilder' shows teambuilder formats (removing parentheses\n\t\t * from format names).\n\t\t */\n\t\tconst selectType: 'teambuilder' | 'challenge' | 'search' = (\n\t\t\troom.parentElem.getAttribute('data-selecttype') as any || 'challenge'\n\t\t);\n\n\t\tconst formats = Object.values(BattleFormats).filter(format => {\n\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return false;\n\t\t\tif (selectType === 'search' && format.searchShow === false) return false;\n\t\t\treturn true;\n\t\t});\n\n\t\tlet curSection = '';\n\t\tlet curColumnNum = 0;\n\t\tlet curColumn: (FormatData | {id: null, section: string})[] = [];\n\t\tconst columns = [curColumn];\n\t\tfor (const format of formats) {\n\t\t\tif (format.column !== curColumnNum) {\n\t\t\t\tif (curColumn.length) {\n\t\t\t\t\tcurColumn = [];\n\t\t\t\t\tcolumns.push(curColumn);\n\t\t\t\t}\n\t\t\t\tcurColumnNum = format.column;\n\t\t\t}\n\t\t\tif (format.section !== curSection) {\n\t\t\t\tcurSection = format.section;\n\t\t\t\tif (curSection) {\n\t\t\t\t\tcurColumn.push({id: null, section: curSection});\n\t\t\t\t}\n\t\t\t}\n\t\t\tcurColumn.push(format);\n\t\t}\n\n\t\tconst width = columns.length * 225 + 10;\n\n\t\treturn <PSPanelWrapper room={room} width={width}>\n\t\t\t{columns.map(column => <ul class=\"options\" onClick={this.click}>\n\t\t\t\t{column.map(format => format.id ? (\n\t\t\t\t\t<li><button value={format.name} class=\"option\">\n\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\n\t\t\t\t\t</button></li>\n\t\t\t\t) : (\n\t\t\t\t\t<li><h3>\n\t\t\t\t\t\t{format.section}\n\t\t\t\t\t</h3></li>\n\t\t\t\t))}\n\t\t\t</ul>)}\n\t\t\t<div style=\"float: left\"></div>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['teamdropdown'] = {\n\tComponent: TeamDropdownPanel,\n};\n\nPS.roomTypes['formatdropdown'] = {\n\tComponent: FormatDropdownPanel,\n};\n"],"mappings":"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"}