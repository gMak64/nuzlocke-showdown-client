{"version":3,"file":"panel-battle.js","names":["BattlesRoom","_PSRoom","_inheritsLoose","options","_this","call","classType","format","battles","refresh","_proto","prototype","setFormat","update","PS","send","toID","PSRoom","BattlesPanel","_PSRoomPanel","_this2","_len","arguments","length","args","Array","_key","apply","concat","props","room","changeFormat","e","value","target","_proto2","renderBattleLink","battle","id","split","minEloMessage","minElo","preact","h","href","style","p1","p2","render","_this3","PSPanelWrapper","scrollable","name","onClick","Dex","getPokemonIcon","title","FormatDropdown","onChange","map","PSRoomPanel","BattleRoom","_ChatRoom","_this4","_len2","_key2","side","request","choices","_proto3","handleMessage","line","startsWith","spaceIndex","indexOf","cmd","slice","play","pause","turnNum","Number","charAt","turn","isNaN","receiveLine","seekTurn","switchViewpoint","isDone","isEmpty","BattleChoiceBuilder","possibleError","addChoice","toString","ChatRoom","BattleDiv","_preact$Component","_proto4","shouldComponentUpdate","Component","MoveButton","type","tooltip","children","moveData","pp","maxpp","PokemonButton","pokemon","disabled","opacity","hpColorClass","BattleScene","getHPColor","noHPBar","fainted","width","Math","round","hp","maxhp","status","BattlePanel","_PSRoomPanel2","_this5","_len3","_key3","text","focusIfNoSelection","selection","window","getSelection","focus","onKey","keyCode","chatLog","base","getElementsByClassName","scrollTop","offsetHeight","toggleBoostedMove","checkbox","currentTarget","current","mega","checked","megax","megay","ultra","z","max","_proto5","querySelector","componentDidMount","_this6","$elem","$","Battle","$frame","find","$logFrame","scene","tooltips","listen","subscribe","forceUpdate","Infinity","receiveRequest","JSON","parse","instantAdd","join","add","fixRequest","myPokemon","setViewpoint","renderControls","renderPlayerControls","atEnd","atQueueEnd","paused","renderMoveControls","dex","pokemonIndex","index","active","currentMoveRequest","maxMoves","canDynamax","moves","i","move","get","maxMoveData","gmaxTooltip","zMoves","zMoveData","renderMoveTargetControls","moveTarget","getChosenMove","moveChoice","stringChoice","userSlot","userSlotCross","farSide","_pokemon","abs","reverse","nearSide","_pokemon2","renderSwitchControls","_choices$currentMoveR","numActive","requestLength","trapped","serverPokemon","cantSwitch","alreadySwitchingIn","includes","renderTeamControls","renderTeamList","team","renderChosenTeam","slot","renderOldChoices","requestType","buf","noCancel","choiceString","choice","parseChoice","choiceType","push","canGigantamax","targetLoc","targetPokemon","moveRequest","alreadyMax","canMegaEvo","alreadyMega","canMegaEvoX","canMegaEvoY","canZMove","alreadyZ","moveName","canShift","gameType","canUltraBurst","ChatLog","left","noSubscription","ChatTextEntry","onMessage","ChatUserList","minimized","role","roomTypes","Model","updateRoomTypes"],"sources":["../src/panel-battle.tsx"],"sourcesContent":["/**\n * Battle panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\ntype BattleDesc = {\n\tid: RoomID,\n\tminElo?: number | string,\n\tp1?: string,\n\tp2?: string,\n\tp3?: string,\n\tp4?: string,\n};\n\nclass BattlesRoom extends PSRoom {\n\toverride readonly classType = 'battles';\n\t/** null means still loading */\n\tformat = '';\n\tbattles: BattleDesc[] | null = null;\n\tconstructor(options: RoomOptions) {\n\t\tsuper(options);\n\t\tthis.refresh();\n\t}\n\tsetFormat(format: string) {\n\t\tif (format === this.format) return this.refresh();\n\t\tthis.battles = null;\n\t\tthis.format = format;\n\t\tthis.update(null);\n\t\tthis.refresh();\n\t}\n\trefresh() {\n\t\tPS.send(`|/cmd roomlist ${toID(this.format)}`);\n\t}\n}\n\nclass BattlesPanel extends PSRoomPanel<BattlesRoom> {\n\trefresh = () => {\n\t\tthis.props.room.refresh();\n\t};\n\tchangeFormat = (e: Event) => {\n\t\tconst value = (e.target as HTMLButtonElement).value;\n\t\tthis.props.room.setFormat(value);\n\t};\n\trenderBattleLink(battle: BattleDesc) {\n\t\tconst format = battle.id.split('-')[1];\n\t\tconst minEloMessage = typeof battle.minElo === 'number' ? `rated ${battle.minElo}` : battle.minElo;\n\t\treturn <div><a href={`/${battle.id}`} class=\"blocklink\">\n\t\t\t{minEloMessage && <small style=\"float:right\">({minEloMessage})</small>}\n\t\t\t<small>[{format}]</small><br />\n\t\t\t<em class=\"p1\">{battle.p1}</em> <small class=\"vs\">vs.</small> <em class=\"p2\">{battle.p2}</em>\n\t\t</a></div>;\n\t}\n\trender() {\n\t\tconst room = this.props.room;\n\t\treturn <PSPanelWrapper room={room} scrollable><div class=\"pad\">\n\t\t\t<button class=\"button\" style=\"float:right;font-size:10pt;margin-top:3px\" name=\"close\"><i class=\"fa fa-times\"></i> Close</button>\n\t\t\t<div class=\"roomlist\">\n\t\t\t\t<p>\n\t\t\t\t\t<button class=\"button\" name=\"refresh\" onClick={this.refresh}><i class=\"fa fa-refresh\"></i> Refresh</button> <span style={Dex.getPokemonIcon('meloetta-pirouette') + ';display:inline-block;vertical-align:middle'} class=\"picon\" title=\"Meloetta is PS's mascot! The Pirouette forme is Fighting-type, and represents our battles.\"></span>\n\t\t\t\t</p>\n\n\t\t\t\t<p>\n\t\t\t\t\t<label class=\"label\">Format:</label><FormatDropdown onChange={this.changeFormat} />\n\t\t\t\t</p>\n\t\t\t\t{/* <label>Minimum Elo: <select name=\"elofilter\"><option value=\"none\">None</option><option value=\"1100\">1100</option><option value=\"1300\">1300</option><option value=\"1500\">1500</option><option value=\"1700\">1700</option><option value=\"1900\">1900</option></select></label>\n\n\t\t\t\t<form class=\"search\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<input type=\"text\" name=\"prefixsearch\" class=\"textbox\" placeholder=\"Username prefix\"/><button type=\"submit\" class=\"button\">Search</button>\n\t\t\t\t\t</p>\n\t\t\t\t</form> */}\n\t\t\t\t<div class=\"list\">{!room.battles ?\n\t\t\t\t\t<p>Loading...</p>\n\t\t\t\t: !room.battles.length ?\n\t\t\t\t\t<p>No battles are going on</p>\n\t\t\t\t:\n\t\t\t\t\troom.battles.map(battle => this.renderBattleLink(battle))\n\t\t\t\t}</div>\n\t\t\t</div>\n\t\t</div></PSPanelWrapper>;\n\t}\n}\n\nclass BattleRoom extends ChatRoom {\n\toverride readonly classType = 'battle';\n\tdeclare pmTarget: null;\n\tdeclare challengeMenuOpen: false;\n\tdeclare challengingFormat: null;\n\tdeclare challengedFormat: null;\n\n\tbattle: Battle = null!;\n\t/** null if spectator, otherwise current player's info */\n\tside: BattleRequestSideInfo | null = null;\n\trequest: BattleRequest | null = null;\n\tchoices: BattleChoiceBuilder | null = null;\n\n\t/**\n\t * @return true to prevent line from being sent to server\n\t */\n\thandleMessage(line: string) {\n\t\tif (!line.startsWith('/') || line.startsWith('//')) return false;\n\t\tconst spaceIndex = line.indexOf(' ');\n\t\tconst cmd = spaceIndex >= 0 ? line.slice(1, spaceIndex) : line.slice(1);\n\t\tconst target = spaceIndex >= 0 ? line.slice(spaceIndex + 1) : '';\n\t\tswitch (cmd) {\n\t\tcase 'play': {\n\t\t\tthis.battle.play();\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'pause': {\n\t\t\tthis.battle.pause();\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'ffto': case 'fastfowardto': {\n\t\t\tlet turnNum = Number(target);\n\t\t\tif (target.charAt(0) === '+' || turnNum < 0) {\n\t\t\t\tturnNum += this.battle.turn;\n\t\t\t\tif (turnNum < 0) turnNum = 0;\n\t\t\t} else if (target === 'end') {\n\t\t\t\tturnNum = -1;\n\t\t\t}\n\t\t\tif (isNaN(turnNum)) {\n\t\t\t\tthis.receiveLine([`error`, `/ffto - Invalid turn number: ${target}`]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis.battle.seekTurn(turnNum);\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'switchsides': {\n\t\t\tthis.battle.switchViewpoint();\n\t\t\treturn true;\n\t\t} case 'cancel': case 'undo': {\n\t\t\tif (!this.choices || !this.request) {\n\t\t\t\tthis.receiveLine([`error`, `/choose - You are not a player in this battle`]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this.choices.isDone() || this.choices.isEmpty()) {\n\t\t\t\tthis.send('/undo', true);\n\t\t\t}\n\t\t\tthis.choices = new BattleChoiceBuilder(this.request);\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'move': case 'switch': case 'team': case 'pass': case 'shift': case 'choose': {\n\t\t\tif (!this.choices) {\n\t\t\t\tthis.receiveLine([`error`, `/choose - You are not a player in this battle`]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst possibleError = this.choices.addChoice(line.slice(cmd === 'choose' ? 8 : 1));\n\t\t\tif (possibleError) {\n\t\t\t\tthis.receiveLine([`error`, possibleError]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this.choices.isDone()) this.send(`/choose ${this.choices.toString()}`, true);\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t}}\n\t\treturn super.handleMessage(line);\n\t}\n}\n\nclass BattleDiv extends preact.Component {\n\tshouldComponentUpdate() {\n\t\treturn false;\n\t}\n\trender() {\n\t\treturn <div class=\"battle\"></div>;\n\t}\n}\n\nfunction MoveButton(props: {\n\tchildren: string, cmd: string, moveData: {pp: number, maxpp: number}, type: TypeName, tooltip: string,\n}) {\n\treturn <button name=\"cmd\" value={props.cmd} class={`type-${props.type} has-tooltip`} data-tooltip={props.tooltip}>\n\t\t{props.children}<br />\n\t\t<small class=\"type\">{props.type}</small> <small class=\"pp\">{props.moveData.pp}/{props.moveData.maxpp}</small>&nbsp;\n\t</button>;\n}\nfunction PokemonButton(props: {\n\tpokemon: Pokemon | ServerPokemon | null, cmd: string, noHPBar?: boolean, disabled?: boolean | 'fade', tooltip: string,\n}) {\n\tconst pokemon = props.pokemon;\n\tif (!pokemon) {\n\t\treturn <button\n\t\t\tname=\"cmd\" value={props.cmd} class={`${props.disabled ? 'disabled ' : ''}has-tooltip`}\n\t\t\tstyle={{opacity: props.disabled === 'fade' ? 0.5 : 1}} data-tooltip={props.tooltip}\n\t\t>\n\t\t\t(empty slot)\n\t\t</button>;\n\t}\n\n\tlet hpColorClass;\n\tswitch (BattleScene.getHPColor(pokemon)) {\n\tcase 'y': hpColorClass = 'hpbar hpbar-yellow'; break;\n\tcase 'r': hpColorClass = 'hpbar hpbar-red'; break;\n\tdefault: hpColorClass = 'hpbar'; break;\n\t}\n\n\treturn <button\n\t\tname=\"cmd\" value={props.cmd} class={`${props.disabled ? 'disabled ' : ''}has-tooltip`}\n\t\tstyle={{opacity: props.disabled === 'fade' ? 0.5 : 1}} data-tooltip={props.tooltip}\n\t>\n\t\t<span class=\"picon\" style={Dex.getPokemonIcon(pokemon)}></span>\n\t\t{pokemon.name}\n\t\t{\n\t\t\t!props.noHPBar && !pokemon.fainted &&\n\t\t\t<span class={hpColorClass}>\n\t\t\t\t<span style={{width: Math.round(pokemon.hp * 92 / pokemon.maxhp) || 1}}></span>\n\t\t\t</span>\n\t\t}\n\t\t{!props.noHPBar && pokemon.status && <span class={`status ${pokemon.status}`}></span>}\n\t</button>;\n}\n\nclass BattlePanel extends PSRoomPanel<BattleRoom> {\n\tsend = (text: string) => {\n\t\tthis.props.room.send(text);\n\t};\n\tfocus() {\n\t\tthis.base!.querySelector('textarea')!.focus();\n\t}\n\tfocusIfNoSelection = () => {\n\t\tconst selection = window.getSelection()!;\n\t\tif (selection.type === 'Range') return;\n\t\tthis.focus();\n\t};\n\tonKey = (e: KeyboardEvent) => {\n\t\tif (e.keyCode === 33) { // Pg Up key\n\t\t\tconst chatLog = this.base!.getElementsByClassName('chat-log')[0] as HTMLDivElement;\n\t\t\tchatLog.scrollTop = chatLog.scrollTop - chatLog.offsetHeight + 60;\n\t\t\treturn true;\n\t\t} else if (e.keyCode === 34) { // Pg Dn key\n\t\t\tconst chatLog = this.base!.getElementsByClassName('chat-log')[0] as HTMLDivElement;\n\t\t\tchatLog.scrollTop = chatLog.scrollTop + chatLog.offsetHeight - 60;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\ttoggleBoostedMove = (e: Event) => {\n\t\tconst checkbox = e.currentTarget as HTMLInputElement;\n\t\tconst choices = this.props.room.choices;\n\t\tif (!choices) return; // shouldn't happen\n\t\tswitch (checkbox.name) {\n\t\tcase 'mega':\n\t\t\tchoices.current.mega = checkbox.checked;\n\t\t\tbreak;\n\t\tcase 'megax':\n\t\t\tchoices.current.megax = checkbox.checked;\n\t\t\tchoices.current.megay = false;\n\t\t\tbreak;\n\t\tcase 'megay':\n\t\t\tchoices.current.megay = checkbox.checked;\n\t\t\tchoices.current.megax = false;\n\t\t\tbreak;\n\t\tcase 'ultra':\n\t\t\tchoices.current.ultra = checkbox.checked;\n\t\t\tbreak;\n\t\tcase 'z':\n\t\t\tchoices.current.z = checkbox.checked;\n\t\t\tbreak;\n\t\tcase 'max':\n\t\t\tchoices.current.max = checkbox.checked;\n\t\t\tbreak;\n\t\t}\n\t\tthis.props.room.update(null);\n\t};\n\tcomponentDidMount() {\n\t\tconst $elem = $(this.base!);\n\t\tconst battle = new Battle({\n\t\t\t$frame: $elem.find('.battle'),\n\t\t\t$logFrame: $elem.find('.battle-log'),\n\t\t});\n\t\tthis.props.room.battle = battle;\n\t\t(battle.scene as BattleScene).tooltips.listen($elem.find('.battle-controls'));\n\t\tsuper.componentDidMount();\n\t\tbattle.subscribe(() => this.forceUpdate());\n\t}\n\treceiveLine(args: Args) {\n\t\tconst room = this.props.room;\n\t\tswitch (args[0]) {\n\t\tcase 'initdone':\n\t\t\troom.battle.seekTurn(Infinity);\n\t\t\treturn;\n\t\tcase 'request':\n\t\t\tthis.receiveRequest(args[1] ? JSON.parse(args[1]) : null);\n\t\t\treturn;\n\t\tcase 'win': case 'tie':\n\t\t\tthis.receiveRequest(null);\n\t\t\tbreak;\n\t\tcase 'c': case 'c:': case 'chat': case 'chatmsg': case 'inactive':\n\t\t\troom.battle.instantAdd('|' + args.join('|'));\n\t\t\treturn;\n\t\tcase 'error':\n\t\t\tif (args[1].startsWith('[Invalid choice]') && room.request) {\n\t\t\t\troom.choices = new BattleChoiceBuilder(room.request);\n\t\t\t\troom.update(null);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\troom.battle.add('|' + args.join('|'));\n\t}\n\treceiveRequest(request: BattleRequest | null) {\n\t\tconst room = this.props.room;\n\t\tif (!request) {\n\t\t\troom.request = null;\n\t\t\troom.choices = null;\n\t\t\treturn;\n\t\t}\n\n\t\tBattleChoiceBuilder.fixRequest(request, room.battle);\n\n\t\tif (request.side) {\n\t\t\troom.battle.myPokemon = request.side.pokemon;\n\t\t\troom.battle.setViewpoint(request.side.id);\n\t\t\troom.side = request.side;\n\t\t}\n\n\t\troom.request = request;\n\t\troom.choices = new BattleChoiceBuilder(request);\n\t\troom.update(null);\n\t}\n\trenderControls() {\n\t\tconst room = this.props.room;\n\t\tif (!room.battle) return null;\n\t\tif (room.side) {\n\t\t\treturn this.renderPlayerControls();\n\t\t}\n\t\tconst atEnd = room.battle.atQueueEnd;\n\t\treturn <div class=\"controls\">\n\t\t\t<p>\n\t\t\t\t{atEnd ?\n\t\t\t\t\t<button class=\"button disabled\" name=\"cmd\" value=\"/play\"><i class=\"fa fa-play\"></i><br />Play</button>\n\t\t\t\t: room.battle.paused ?\n\t\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/play\"><i class=\"fa fa-play\"></i><br />Play</button>\n\t\t\t\t:\n\t\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/pause\"><i class=\"fa fa-pause\"></i><br />Pause</button>\n\t\t\t\t} {}\n\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/ffto -1\"><i class=\"fa fa-step-backward\"></i><br />Last turn</button>\n\t\t\t\t<button class={\"button\" + (atEnd ? \" disabled\" : \"\")} name=\"cmd\" value=\"/ffto +1\"><i class=\"fa fa-step-forward\"></i><br />Skip turn</button> {}\n\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/ffto 0\"><i class=\"fa fa-undo\"></i><br />First turn</button>\n\t\t\t\t<button class={\"button\" + (atEnd ? \" disabled\" : \"\")} name=\"cmd\" value=\"/ffto end\"><i class=\"fa fa-fast-forward\"></i><br />Skip to end</button>\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/switchsides\"><i class=\"fa fa-random\"></i> Switch sides</button>\n\t\t\t</p>\n\t\t</div>;\n\t}\n\trenderMoveControls(request: BattleMoveRequest, choices: BattleChoiceBuilder) {\n\t\tconst dex = this.props.room.battle.dex;\n\t\tconst pokemonIndex = choices.index();\n\t\tconst active = choices.currentMoveRequest();\n\t\tif (!active) return <div class=\"message-error\">Invalid pokemon</div>;\n\n\t\tif (choices.current.max || (active.maxMoves && !active.canDynamax)) {\n\t\t\tif (!active.maxMoves) {\n\t\t\t\treturn <div class=\"message-error\">Maxed with no max moves</div>;\n\t\t\t}\n\t\t\treturn active.moves.map((moveData, i) => {\n\t\t\t\tconst move = dex.moves.get(moveData.name);\n\t\t\t\tconst maxMoveData = active.maxMoves![i];\n\t\t\t\tconst gmaxTooltip = maxMoveData.id.startsWith('gmax') ? `|${maxMoveData.id}` : ``;\n\t\t\t\tconst tooltip = `maxmove|${moveData.name}|${pokemonIndex}${gmaxTooltip}`;\n\t\t\t\treturn <MoveButton cmd={`/move ${i + 1} max`} type={move.type} tooltip={tooltip} moveData={moveData}>\n\t\t\t\t\t{maxMoveData.name}\n\t\t\t\t</MoveButton>;\n\t\t\t});\n\t\t}\n\n\t\tif (choices.current.z) {\n\t\t\tif (!active.zMoves) {\n\t\t\t\treturn <div class=\"message-error\">No Z moves</div>;\n\t\t\t}\n\t\t\treturn active.moves.map((moveData, i) => {\n\t\t\t\tconst move = dex.moves.get(moveData.name);\n\t\t\t\tconst zMoveData = active.zMoves![i];\n\t\t\t\tif (!zMoveData) {\n\t\t\t\t\treturn <button disabled>&nbsp;</button>;\n\t\t\t\t}\n\t\t\t\tconst tooltip = `zmove|${moveData.name}|${pokemonIndex}`;\n\t\t\t\treturn <MoveButton cmd={`/move ${i + 1} zmove`} type={move.type} tooltip={tooltip} moveData={{pp: 1, maxpp: 1}}>\n\t\t\t\t\t{zMoveData.name}\n\t\t\t\t</MoveButton>;\n\t\t\t});\n\t\t}\n\n\t\treturn active.moves.map((moveData, i) => {\n\t\t\tconst move = dex.moves.get(moveData.name);\n\t\t\tconst tooltip = `move|${moveData.name}|${pokemonIndex}`;\n\t\t\treturn <MoveButton cmd={`/move ${i + 1}`} type={move.type} tooltip={tooltip} moveData={moveData}>\n\t\t\t\t{move.name}\n\t\t\t</MoveButton>;\n\t\t});\n\t}\n\trenderMoveTargetControls(request: BattleMoveRequest, choices: BattleChoiceBuilder) {\n\t\tconst battle = this.props.room.battle;\n\t\tconst moveTarget = choices.getChosenMove(choices.current, choices.index()).target;\n\t\tconst moveChoice = choices.stringChoice(choices.current);\n\n\t\tconst userSlot = choices.index();\n\t\tconst userSlotCross = battle.farSide.active.length - 1 - userSlot;\n\n\t\treturn [\n\t\t\tbattle.farSide.active.map((pokemon, i) => {\n\t\t\t\tlet disabled = false;\n\t\t\t\tif (moveTarget === 'adjacentAlly' || moveTarget === 'adjacentAllyOrSelf') {\n\t\t\t\t\tdisabled = true;\n\t\t\t\t} else if (moveTarget === 'normal' || moveTarget === 'adjacentFoe') {\n\t\t\t\t\tif (Math.abs(userSlotCross - i) > 1) disabled = true;\n\t\t\t\t}\n\n\t\t\t\tif (pokemon?.fainted) pokemon = null;\n\t\t\t\treturn <PokemonButton\n\t\t\t\t\tpokemon={pokemon}\n\t\t\t\t\tcmd={disabled ? `` : `/${moveChoice} +${i + 1}`} disabled={disabled && 'fade'} tooltip={`activepokemon|1|${i}`}\n\t\t\t\t/>;\n\t\t\t}).reverse(),\n\t\t\t<div style=\"clear: left\"></div>,\n\t\t\tbattle.nearSide.active.map((pokemon, i) => {\n\t\t\t\tlet disabled = false;\n\t\t\t\tif (moveTarget === 'adjacentFoe') {\n\t\t\t\t\tdisabled = true;\n\t\t\t\t} else if (moveTarget === 'normal' || moveTarget === 'adjacentAlly' || moveTarget === 'adjacentAllyOrSelf') {\n\t\t\t\t\tif (Math.abs(userSlot - i) > 1) disabled = true;\n\t\t\t\t}\n\t\t\t\tif (moveTarget !== 'adjacentAllyOrSelf' && userSlot === i) disabled = true;\n\n\t\t\t\tif (pokemon?.fainted) pokemon = null;\n\t\t\t\treturn <PokemonButton\n\t\t\t\t\tpokemon={pokemon}\n\t\t\t\t\tcmd={disabled ? `` : `/${moveChoice} -${i + 1}`} disabled={disabled && 'fade'} tooltip={`activepokemon|0|${i}`}\n\t\t\t\t/>;\n\t\t\t}),\n\t\t];\n\t}\n\trenderSwitchControls(request: BattleMoveRequest | BattleSwitchRequest, choices: BattleChoiceBuilder) {\n\t\tconst numActive = choices.requestLength();\n\n\t\tconst trapped = choices.currentMoveRequest()?.trapped;\n\n\t\treturn request.side.pokemon.map((serverPokemon, i) => {\n\t\t\tconst cantSwitch = trapped || i < numActive || choices.alreadySwitchingIn.includes(i + 1) || serverPokemon.fainted;\n\t\t\treturn <PokemonButton\n\t\t\t\tpokemon={serverPokemon} cmd={`/switch ${i + 1}`} disabled={cantSwitch} tooltip={`switchpokemon|${i}`}\n\t\t\t/>;\n\t\t});\n\t}\n\trenderTeamControls(request: | BattleTeamRequest, choices: BattleChoiceBuilder) {\n\t\treturn request.side.pokemon.map((serverPokemon, i) => {\n\t\t\tconst cantSwitch = choices.alreadySwitchingIn.includes(i + 1);\n\t\t\treturn <PokemonButton\n\t\t\t\tpokemon={serverPokemon} cmd={`/switch ${i + 1}`} noHPBar disabled={cantSwitch && 'fade'} tooltip={`switchpokemon|${i}`}\n\t\t\t/>;\n\t\t});\n\t}\n\trenderTeamList() {\n\t\tconst team = this.props.room.battle.myPokemon;\n\t\tif (!team) return;\n\t\treturn <div class=\"switchcontrols\">\n\t\t\t<h3 class=\"switchselect\">Team</h3>\n\t\t\t<div class=\"switchmenu\">\n\t\t\t\t{team.map((serverPokemon, i) => {\n\t\t\t\t\treturn <PokemonButton\n\t\t\t\t\t\tpokemon={serverPokemon} cmd={``} noHPBar disabled={true} tooltip={`switchpokemon|${i}`}\n\t\t\t\t\t/>;\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\trenderChosenTeam(request: BattleTeamRequest, choices: BattleChoiceBuilder) {\n\t\treturn choices.alreadySwitchingIn.map(slot => {\n\t\t\tconst serverPokemon = request.side.pokemon[slot - 1];\n\t\t\treturn <PokemonButton\n\t\t\t\tpokemon={serverPokemon} cmd={`/switch ${slot}`} disabled tooltip={`switchpokemon|${slot - 1}`}\n\t\t\t/>;\n\t\t});\n\t}\n\trenderOldChoices(request: BattleRequest, choices: BattleChoiceBuilder) {\n\t\tif (!choices) return null; // should not happen\n\t\tif (request.requestType !== 'move' && request.requestType !== 'switch') return;\n\t\tif (choices.isEmpty()) return null;\n\n\t\tlet buf: preact.ComponentChild[] = [\n\t\t\t<button name=\"cmd\" value=\"/cancel\" class=\"button\"><i class=\"fa fa-chevron-left\"></i> Back</button>, ' ',\n\t\t];\n\t\tif (choices.isDone() && request.noCancel) {\n\t\t\tbuf = ['Waiting for opponent...'];\n\t\t}\n\n\t\tconst battle = this.props.room.battle;\n\t\tfor (let i = 0; i < choices.choices.length; i++) {\n\t\t\tconst choiceString = choices.choices[i];\n\t\t\tconst choice = choices.parseChoice(choiceString);\n\t\t\tif (!choice) continue;\n\t\t\tconst pokemon = request.side.pokemon[i];\n\t\t\tconst active = request.requestType === 'move' ? request.active[i] : null;\n\t\t\tif (choice.choiceType === 'move') {\n\t\t\t\tbuf.push(`${pokemon.name} will `);\n\t\t\t\tif (choice.mega) buf.push(`Mega Evolve and `);\n\t\t\t\tif (choice.ultra) buf.push(`Ultra Burst and `);\n\t\t\t\tif (choice.max && active?.canDynamax) buf.push(active?.canGigantamax ? `Gigantamax and ` : `Dynamax and `);\n\t\t\t\tbuf.push(`use `, <strong>{choices.getChosenMove(choice, i).name}</strong>);\n\t\t\t\tif (choice.targetLoc > 0) {\n\t\t\t\t\tconst target = battle.farSide.active[choice.targetLoc - 1];\n\t\t\t\t\tif (!target) {\n\t\t\t\t\t\tbuf.push(` at slot ${choice.targetLoc}`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuf.push(` at ${target.name}`);\n\t\t\t\t\t}\n\t\t\t\t} else if (choice.targetLoc < 0) {\n\t\t\t\t\tconst target = battle.nearSide.active[-choice.targetLoc - 1];\n\t\t\t\t\tif (!target) {\n\t\t\t\t\t\tbuf.push(` at ally slot ${choice.targetLoc}`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuf.push(` at ally ${target.name}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (choice.choiceType === 'switch') {\n\t\t\t\tconst target = request.side.pokemon[choice.targetPokemon - 1];\n\t\t\t\tbuf.push(`${pokemon.name} will switch to `, <strong>{target.name}</strong>);\n\t\t\t} else if (choice.choiceType === 'shift') {\n\t\t\t\tbuf.push(`${pokemon.name} will `, <strong>shift</strong>, ` to the center`);\n\t\t\t}\n\t\t\tbuf.push(<br />);\n\t\t}\n\t\treturn buf;\n\t}\n\trenderPlayerControls() {\n\t\tconst room = this.props.room;\n\t\tconst request = room.request;\n\t\tlet choices = room.choices;\n\t\tif (!request) return 'Error: Missing request';\n\t\tif (!choices) return 'Error: Missing BattleChoiceBuilder';\n\t\tif (choices.request !== request) {\n\t\t\tchoices = new BattleChoiceBuilder(request);\n\t\t\troom.choices = choices;\n\t\t}\n\n\t\tif (choices.isDone()) {\n\t\t\treturn <div class=\"controls\">\n\t\t\t\t<div class=\"whatdo\">\n\t\t\t\t\t<button name=\"openTimer\" class=\"button disabled timerbutton\"><i class=\"fa fa-hourglass-start\"></i> Timer</button>\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"pad\">\n\t\t\t\t\t{request.noCancel ? null : <button name=\"cmd\" value=\"/cancel\" class=\"button\">Cancel</button>}\n\t\t\t\t</div>\n\t\t\t\t{this.renderTeamList()}\n\t\t\t</div>;\n\t\t}\n\t\tif (request.side) room.battle.myPokemon = request.side.pokemon;\n\t\tswitch (request.requestType) {\n\t\tcase 'move': {\n\t\t\tconst index = choices.index();\n\t\t\tconst pokemon = request.side.pokemon[index];\n\t\t\tconst moveRequest = choices.currentMoveRequest()!;\n\n\t\t\tconst canDynamax = moveRequest.canDynamax && !choices.alreadyMax;\n\t\t\tconst canMegaEvo = moveRequest.canMegaEvo && !choices.alreadyMega;\n\t\t\tconst canMegaEvoX = moveRequest.canMegaEvoX && !choices.alreadyMega;\n\t\t\tconst canMegaEvoY = moveRequest.canMegaEvoY && !choices.alreadyMega;\n\t\t\tconst canZMove = moveRequest.zMoves && !choices.alreadyZ;\n\n\t\t\tif (choices.current.move) {\n\t\t\t\tconst moveName = choices.getChosenMove(choices.current, choices.index()).name;\n\t\t\t\treturn <div class=\"controls\">\n\t\t\t\t\t<div class=\"whatdo\">\n\t\t\t\t\t\t<button name=\"openTimer\" class=\"button disabled timerbutton\"><i class=\"fa fa-hourglass-start\"></i> Timer</button>\n\t\t\t\t\t\t{this.renderOldChoices(request, choices)}\n\t\t\t\t\t\t{pokemon.name} should use <strong>{moveName}</strong> at where? {}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"switchcontrols\">\n\t\t\t\t\t\t<div class=\"switchmenu\">\n\t\t\t\t\t\t\t{this.renderMoveTargetControls(request, choices)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>;\n\t\t\t}\n\n\t\t\tconst canShift = room.battle.gameType === 'triples' && index !== 1;\n\n\t\t\treturn <div class=\"controls\">\n\t\t\t\t<div class=\"whatdo\">\n\t\t\t\t\t<button name=\"openTimer\" class=\"button disabled timerbutton\"><i class=\"fa fa-hourglass-start\"></i> Timer</button>\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\n\t\t\t\t\tWhat will <strong>{pokemon.name}</strong> do?\n\t\t\t\t</div>\n\t\t\t\t<div class=\"movecontrols\">\n\t\t\t\t\t<h3 class=\"moveselect\">Attack</h3>\n\t\t\t\t\t<div class=\"movemenu\">\n\t\t\t\t\t\t{this.renderMoveControls(request, choices)}\n\t\t\t\t\t\t<div style=\"clear:left\"></div>\n\t\t\t\t\t\t{canDynamax && <label class={`megaevo${choices.current.max ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"max\" checked={choices.current.max} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\t{moveRequest.canGigantamax ? 'Gigantamax' : 'Dynamax'}\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t\t{canMegaEvo && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"mega\" checked={choices.current.mega} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\tMega Evolution\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t\t{canMegaEvoX && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"megax\" checked={choices.current.megax} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\tMega Evolution X\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t\t{canMegaEvoY && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"megay\" checked={choices.current.megay} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\tMega Evolution Y\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t\t{moveRequest.canUltraBurst && <label class={`megaevo${choices.current.ultra ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"ultra\" checked={choices.current.ultra} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\tUltra Burst\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t\t{canZMove && <label class={`megaevo${choices.current.z ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"z\" checked={choices.current.z} onChange={this.toggleBoostedMove} /> {}\n\t\t\t\t\t\t\tZ-Power\n\t\t\t\t\t\t</label>}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"switchcontrols\">\n\t\t\t\t\t{canShift && [\n\t\t\t\t\t\t<h3 class=\"shiftselect\">Shift</h3>,\n\t\t\t\t\t\t<button name=\"cmd\" value=\"/shift\">Move to center</button>,\n\t\t\t\t\t]}\n\t\t\t\t\t<h3 class=\"switchselect\">Switch</h3>\n\t\t\t\t\t<div class=\"switchmenu\">\n\t\t\t\t\t\t{this.renderSwitchControls(request, choices)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t} case 'switch': {\n\t\t\tconst pokemon = request.side.pokemon[choices.index()];\n\t\t\treturn <div class=\"controls\">\n\t\t\t\t<div class=\"whatdo\">\n\t\t\t\t\t<button name=\"openTimer\" class=\"button disabled timerbutton\"><i class=\"fa fa-hourglass-start\"></i> Timer</button>\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\n\t\t\t\t\tWhat will <strong>{pokemon.name}</strong> do?\n\t\t\t\t</div>\n\t\t\t\t<div class=\"switchcontrols\">\n\t\t\t\t\t<h3 class=\"switchselect\">Switch</h3>\n\t\t\t\t\t<div class=\"switchmenu\">\n\t\t\t\t\t\t{this.renderSwitchControls(request, choices)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t} case 'team': {\n\t\t\treturn <div class=\"controls\">\n\t\t\t\t<div class=\"whatdo\">\n\t\t\t\t\t<button name=\"openTimer\" class=\"button disabled timerbutton\"><i class=\"fa fa-hourglass-start\"></i> Timer</button>\n\t\t\t\t\t{choices.alreadySwitchingIn.length > 0 ?\n\t\t\t\t\t\t[<button name=\"cmd\" value=\"/cancel\" class=\"button\"><i class=\"fa fa-chevron-left\"></i> Back</button>,\n\t\t\t\t\t\t\" What about the rest of your team? \"]\n\t\t\t\t\t:\n\t\t\t\t\t\t\"How will you start the battle? \"\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"switchcontrols\">\n\t\t\t\t\t<h3 class=\"switchselect\">Choose {choices.alreadySwitchingIn.length <= 0 ? `lead` : `slot ${choices.alreadySwitchingIn.length + 1}`}</h3>\n\t\t\t\t\t<div class=\"switchmenu\">\n\t\t\t\t\t\t{this.renderTeamControls(request, choices)}\n\t\t\t\t\t\t<div style=\"clear:left\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"switchcontrols\">\n\t\t\t\t\t{choices.alreadySwitchingIn.length > 0 && <h3 class=\"switchselect\">Team so far</h3>}\n\t\t\t\t\t<div class=\"switchmenu\">\n\t\t\t\t\t\t{this.renderChosenTeam(request, choices)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}}\n\t}\n\trender() {\n\t\tconst room = this.props.room;\n\n\t\treturn <PSPanelWrapper room={room}>\n\t\t\t<BattleDiv></BattleDiv>\n\t\t\t<ChatLog class=\"battle-log hasuserlist\" room={this.props.room} onClick={this.focusIfNoSelection} left={640} noSubscription>\n\t\t\t\t{}\n\t\t\t</ChatLog>\n\t\t\t<ChatTextEntry room={this.props.room} onMessage={this.send} onKey={this.onKey} left={640} />\n\t\t\t<ChatUserList room={this.props.room} left={640} minimized />\n\t\t\t<div class=\"battle-controls\" role=\"complementary\" aria-label=\"Battle Controls\" style=\"top: 370px;\">\n\t\t\t\t{this.renderControls()}\n\t\t\t</div>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['battle'] = {\n\tModel: BattleRoom,\n\tComponent: BattlePanel,\n};\nPS.roomTypes['battles'] = {\n\tModel: BattlesRoom,\n\tComponent: BattlesPanel,\n};\nPS.updateRoomTypes();\n"],"mappings":"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","ignoreList":[]}